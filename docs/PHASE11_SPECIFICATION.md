# Фаза 11: Новый пользовательский интерфейс isocubic

## Техническое задание (ТЗ)

### Цель
Разработка нового настраиваемого пользовательского интерфейса с оконным менеджером, обеспечивающего удобный доступ ко всему функционалу приложения на всех устройствах.

### Требования

#### 1. Оконный менеджер (Window Manager)
- Каждый компонент приложения отображается в отдельном окне
- Окна поддерживают:
  - **Перетаскивание** (drag) — за заголовок окна
  - **Изменение размера** (resize) — за правый нижний угол
  - **Сворачивание** (minimize) — в панель задач внизу экрана
  - **Закрытие** (close) — с возможностью повторного открытия
  - **Z-order** — клик по окну выносит его на передний план
- Состояние окон (позиция, размер, открыто/свёрнуто) сохраняется в localStorage
- **Адаптивность**: на мобильных устройствах окна автоматически масштабируются под размер экрана

#### 2. Доступные окна компонентов
Все функциональные компоненты из предыдущих фаз доступны как окна:

**Основные компоненты:**
- **Gallery** — галерея пресетов кубов
- **CubePreview** — 3D превью текущего куба
- **UnifiedEditor** — редактор параметров (Spectral, FFT, Stack)
- **PromptGenerator** — генерация кубов по описанию (AI)
- **ExportPanel** — экспорт/импорт кубов
- **ActionHistory** — история действий с undo/redo

**Социальные и коллаборация:**
- **CommunityGallery** — галерея сообщества (публичные кубы)
- **SharePanel** — панель публикации и шеринга
- **NotificationPanel** — системные уведомления

**Дополнительные окна (доступны через командную строку):**
- **DevModeQueryPanel** — панель AI-запросов для разработчиков (GOD MODE)
- **ConversationPanel** — панель диалога с AI агентом
- **ExtendedSearchPanel** — расширенный поиск компонентов

#### 3. Командная строка TinyLLM
- Расположена в верхней части главного окна
- Позволяет:
  - Искать и открывать окна компонентов по имени
  - Выполнять действия: генерация куба, экспорт, поиск пресета
  - Быстрый доступ к настройкам
- Активация: клик по строке или горячая клавиша (Ctrl+K)
- Интеграция с TinyLLM для понимания естественного языка

### Архитектура

#### Новые файлы
1. `src/composables/useWindowManager.ts` — composable для управления состоянием окон
2. `src/components/DraggableWindow.vue` — компонент перетаскиваемого окна
3. `src/components/CommandBar.vue` — командная строка TinyLLM
4. `src/components/WindowTaskbar.vue` — панель задач со свёрнутыми окнами

#### Изменения в существующих файлах
- `src/App.vue` — интеграция нового оконного лейаута для всех размеров экранов
- `src/App.css` — стили для адаптивного оконного лейаута

### План реализации

| # | Задача | Описание |
|---|--------|----------|
| 1 | useWindowManager | Composable: позиции, размеры, z-order, localStorage |
| 2 | DraggableWindow | Компонент окна с drag, resize, minimize, close |
| 3 | CommandBar | Командная строка с поиском компонентов |
| 4 | WindowTaskbar | Панель задач для свёрнутых окон |
| 5 | Интеграция App.vue | Новый лейаут с оконным менеджером для всех устройств |
| 6 | Адаптивность | Адаптация окон для мобильных и планшетов |
| 7 | Расширение функционала | Добавление всех компонентов из предыдущих фаз |
| 8 | Тесты | Unit-тесты для всех новых компонентов |

### Совместимость
- **Планшетный и мобильный лейауты** адаптированы под все размеры экранов, включая мобильные телефоны
- **Новый оконный интерфейс** доступен на всех устройствах (адаптивный):
  - Desktop: полноценные окна с drag/resize
  - Tablet: окна с ограниченным перетаскиванием, оптимизированные под касания
  - Mobile: окна занимают полную ширину, доступны через меню или табы
- **Существующий функционал** всех 10 фаз полностью сохранён и расширен:
  - Все компоненты интегрированы в оконный интерфейс
  - Доступ к функционалу через командную строку TinyLLM
  - Сохранение состояния между сессиями

### Особенности реализации

#### Адаптивность окон
- **Desktop (>1024px)**: Полноценные окна с drag, resize, minimize
- **Tablet (768-1024px)**: Окна с упрощённым управлением, адаптированные под touch
- **Mobile (<768px)**: Окна в виде модальных панелей или табов, оптимизированные для маленьких экранов

#### Управление состоянием
- Позиции окон сохраняются отдельно для каждого размера экрана
- При изменении размера экрана окна автоматически адаптируются
- Сброс лейаута возвращает окна к позициям по умолчанию для текущего размера экрана
