# isocubic

Веб-редактор параметрических кубиков для создания изометрических 3D-миров.

## О проекте

**isocubic** — это веб-приложение для создания и редактирования параметрических воксельных кубиков. Проект вдохновлён классическими играми Diablo 1 и X-COM: UFO, но использует современный стек технологий для работы в браузере.

### Ключевые особенности

- **Параметрическое описание** — кубики хранятся как компактные JSON-конфиги, а не как тяжёлые текстуры
- **Процедурная генерация** — градиенты, шум Perlin/Worley и другие эффекты создаются в реальном времени
- **ИИ-генерация** — создание кубиков по текстовому описанию с помощью TinyLLM
- **Бесшовная сшивка** — соседние кубики плавно соединяются без видимых границ
- **Высокая производительность** — 60 FPS на мобильных устройствах
- **Работает offline** — PWA-приложение работает без интернета после первой загрузки

## Архитектура

isocubic использует **параметрический подход** для описания кубиков:

```
┌─────────────────────────────────────────────────────────────┐
│                     JSON-конфиг кубика                      │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐ │
│  │ Base Color  │  │  Gradients  │  │   Procedural Noise  │ │
│  │ [R, G, B]   │  │  axis, shift │  │  type, scale, mask  │ │
│  └─────────────┘  └─────────────┘  └─────────────────────┘ │
└─────────────────────────┬───────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────────────┐
│                    GLSL-шейдер (GPU)                        │
│  • Расчёт цвета по параметрам                               │
│  • Генерация шума в реальном времени                        │
│  • Интерполяция на границах                                 │
└─────────────────────────┬───────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────────────┐
│                  Three.js / WebGL рендеринг                 │
│  • Изометрическая камера                                    │
│  • Освещение и тени                                         │
│  • Интерактивное управление                                 │
└─────────────────────────────────────────────────────────────┘
```

### Формат конфигурации кубика

```json
{
  "id": "stone_moss_001",
  "prompt": "каменная кладка с мхом",
  "base": {
    "color": [0.65, 0.55, 0.45],
    "roughness": 0.8,
    "transparency": 1.0
  },
  "gradients": [
    {
      "axis": "y",
      "factor": 0.3,
      "color_shift": [0.2, 0.35, 0.15]
    }
  ],
  "noise": {
    "type": "perlin",
    "scale": 8.0,
    "octaves": 4,
    "persistence": 0.6,
    "mask": "bottom_40%"
  },
  "physics": {
    "material": "stone",
    "density": 2.5,
    "break_pattern": "crumble"
  }
}
```

## Технологический стек

| Технология | Назначение |
|------------|------------|
| React | UI-компоненты |
| TypeScript | Типизация |
| Three.js | 3D-рендеринг |
| @react-three/fiber | React-обёртка для Three.js |
| @react-three/drei | Готовые компоненты для Three.js |
| Tailwind CSS | Стилизация |
| TensorFlow.js | Клиентский ИИ (TinyLLM) |
| Vite | Сборка |
| Vitest | Тестирование |

## Быстрый старт

### Требования

- Node.js >= 18
- npm >= 9

### Установка

```bash
# Клонирование репозитория
git clone https://github.com/netkeep80/isocubic.git
cd isocubic

# Установка зависимостей
npm install

# Запуск в режиме разработки
npm run dev
```

### Команды

| Команда | Описание |
|---------|----------|
| `npm run dev` | Запуск dev-сервера |
| `npm run build` | Сборка для production |
| `npm run preview` | Предпросмотр production-сборки |
| `npm run test` | Запуск тестов |
| `npm run lint` | Проверка кода |

## Структура проекта

```
isocubic/
├── src/
│   ├── components/        # React-компоненты
│   │   ├── CubePreview.tsx    # 3D-превью куба
│   │   ├── ParamEditor.tsx    # Редактор параметров
│   │   ├── PromptGenerator.tsx # Генерация по промпту
│   │   ├── Gallery.tsx        # Галерея примеров
│   │   └── ExportPanel.tsx    # Экспорт/импорт
│   ├── shaders/           # GLSL-шейдеры
│   │   └── parametric-cube.glsl
│   ├── lib/               # Утилиты
│   │   ├── tinyLLM.ts         # ИИ-генератор
│   │   ├── storage.ts         # Работа с хранилищем
│   │   └── validation.ts      # Валидация схемы
│   ├── types/             # TypeScript-типы
│   │   └── cube.ts
│   └── App.tsx
├── public/
│   └── model/             # Модель TinyLLM
├── examples/              # Примеры конфигов
├── ANALYSIS.md            # Анализ подходов
├── TASKS.md               # План задач MVP
└── README.md
```

## Использование

### Создание кубика по промпту

1. Введите описание в текстовое поле: *"каменная стена с трещинами и мхом"*
2. Нажмите "Создать по описанию"
3. ИИ сгенерирует параметры автоматически

### Ручное редактирование

1. Выберите кубик из галереи или создайте новый
2. Настройте параметры в панели справа:
   - **Базовый цвет** — основной цвет материала
   - **Градиенты** — изменение цвета по осям
   - **Шум** — текстура поверхности
   - **Физика** — свойства материала
3. Сохраните или экспортируйте результат

### Экспорт

- **JSON** — для использования в других проектах
- **PNG** — скриншот превью
- **LocalStorage** — автосохранение в браузере

## Roadmap

### Фаза 1: MVP (текущая)

- [x] Анализ подходов (ANALYSIS.md)
- [x] Инициализация проекта
- [x] JSON-схема конфигов
- [ ] Базовый шейдер
- [ ] 3D-превью
- [ ] Редактор параметров
- [ ] Генерация по промпту (TinyLLM)
- [ ] Сшивка границ
- [x] Экспорт/импорт
- [ ] Галерея примеров
- [ ] Мобильная оптимизация
- [ ] Деплой

### Фаза 2: FFT для магических объектов

- [ ] WASM-модуль для FFT
- [ ] Энергетическая визуализация
- [ ] Физика разрушения
- [ ] Магические эффекты

### Фаза 3: Оптимизация

- [ ] LOD-система
- [ ] WebGPU compute-шейдеры
- [ ] Расширенный ИИ
- [ ] Система "стопок кубиков"

## Вклад в проект

Мы приветствуем вклад в развитие isocubic!

1. Форкните репозиторий
2. Создайте ветку для фичи: `git checkout -b feature/amazing-feature`
3. Закоммитьте изменения: `git commit -m 'Add amazing feature'`
4. Запушьте в ветку: `git push origin feature/amazing-feature`
5. Откройте Pull Request

### Правила

- Следуйте code style (ESLint + Prettier)
- Покрывайте новый код тестами
- Обновляйте документацию при необходимости
- Пишите понятные commit messages

## Лицензия

MIT License — см. файл [LICENSE](LICENSE)

## Связь

- **GitHub Issues** — для багов и предложений
- **Discussions** — для вопросов и обсуждений

---

*Создано с использованием современных веб-технологий для работы в любом браузере.*
